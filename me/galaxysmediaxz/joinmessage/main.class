package me.galaxysmediaxz.joinmessage;

import org.bukkit.Bukkit;
import org.bukkit.command.Command;
import org.bukkit.command.CommandSender;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.player.PlayerJoinEvent;
import org.bukkit.plugin.java.JavaPlugin;

public class main extends JavaPlugin implements Listener {
    @Override
    public void onEnable() {
        super.onEnable();
        getServer().getLogger().info("Reading config...");
        Bukkit.getServer().getPluginManager().registerEvents(this, this);
        getConfig().options().copyDefaults(true);
        saveConfig();
        getConfig();
    }

    @EventHandler
    public void onPlayerJoin(PlayerJoinEvent e) {
        Player p = e.getPlayer();
        p.sendMessage(getConfig().getString("Welcome-Message").replace("{player}", p.getName().replace("C", "ยง")));
    }

    @Override
    public void onDisable() {
        saveConfig();
        super.onDisable();
    }

    @Override
    public void onLoad(){
        Bukkit.getServer().getLogger().info("Reloading Config...");
        super.onLoad();
        reloadConfig();
        saveConfig();
    }

    @Override
    public boolean onCommand(CommandSender sender, Command command, String label, String[] args) {
        Player p = (Player) sender;

        if (command.getName().equalsIgnoreCase("jtagbrel")) {

        }
        sender.sendMessage(getConfig().getString("Try-to-reload-to-player").replace("{player}", p.getName().replace("C", "ยง")));
        getServer().getLogger().info(getConfig().getString("Try-to-reload-to-console").replace("{player}", p.getName().replace("C", "ยง")));
        reloadConfig();
        saveConfig();
        sender.sendMessage(getConfig().getString("Reload-Complete").replace("{player}", p.getName().replace("C", "ยง")));
        return true;
    }
}
